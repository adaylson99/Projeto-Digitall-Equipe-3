{
 "cells": [
  {
   "attachments": {},
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "------VERIFICANDO A SOMA DOS VALORES DAS COLUNAS DE PAGAMENTO--------\n",
    "------Nessa etapa iremos verificar os valores contidos nas colunas de pagamento, para ter uma visão geral do banco de dados---\n",
    "\n",
    "----Fazer uma análise dos valores contidos na tabela, é importante por vários motivos:\n",
    "\n",
    "----Verificação da integridade dos dados: Ao analisar os valores nas tabelas, é possível identificar se existem valores inconsistentes, \n",
    "--como valores negativos onde deveriam ser positivos, valores nulos onde não deveriam ser, ou\n",
    "--valores que excedem limites pré-definidos. Essa verificação ajuda a garantir a integridade dos dados armazenados no banco de dados.\n",
    "\n",
    "--Identificação de discrepâncias e erros: Ao realizar cálculos e análises nos valores das tabelas, é possível identificar discrepâncias, \n",
    "--erros ou inconsistências nos dados. Por exemplo, se a soma de uma coluna que deveria representar um valor total não corresponder ao valor \n",
    "--esperado, pode indicar um problema nos dados ou nos processos de entrada de dados.\n",
    "\n",
    "--Estatísticas e métricas: Analisar os valores nas tabelas pode fornecer estatísticas e métricas importantes sobre os dados.\n",
    "--Por exemplo, ao calcular a soma total de um determinado campo, você pode obter informações sobre o total acumulado de valores em uma tabela. \n",
    "--Isso pode ser útil para análises financeiras, relatórios de desempenho, previsões e outras análises estatísticas.\n",
    "\n",
    "--Verificação de consistência entre tabelas: Ao comparar valores entre diferentes tabelas ou colunas, é possível identificar \n",
    "--discrepâncias ou inconsistências nos dados. Por exemplo, se houver uma tabela de pedidos e uma tabela de pagamentos, você pode \n",
    "--verificar se os valores totais dos pagamentos correspondem aos valores totais dos pedidos para garantir a consistência entre os dados.\n",
    "\n",
    "--Validação de resultados: Ao realizar cálculos complexos ou agregações nos valores das tabelas, é importante validar os resultados \n",
    "--para garantir sua precisão. Fazer análises de valores permite que você verifique se os resultados obtidos estão corretos e de acordo \n",
    "--com as expectativas.\n"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "SELECT dsc_nome_credor\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_nome_credor <> UPPER(dsc_nome_credor);\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_orgao\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_orgao <> UPPER(dsc_orgao);\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_fonte\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_fonte <> UPPER(dsc_fonte);\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_funcao\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_funcao <> UPPER(dsc_funcao);\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_item \n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_item <> UPPER(dsc_item);\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_item_elemento\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_item_elemento <> UPPER(dsc_item_elemento)\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_item_categoria\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_item_categoria <> UPPER(dsc_item_categoria);\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_item_grupo\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_item_grupo <> UPPER(dsc_item_grupo);\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_modalidade_licitacao\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_modalidade_licitacao <> UPPER(dsc_modalidade_licitacao);\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_item_modalidade\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_item_modalidade <> UPPER(dsc_item_modalidade)\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_programa\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_programa <> UPPER(dsc_programa);\n",
    "-------------------------------------------------------------------\n",
    "SELECT dsc_subfuncao\n",
    "FROM execucao_financeira_despesa\n",
    "WHERE dsc_subfuncao <> UPPER(dsc_subfuncao);\n",
    "-------------------------------------------------------------------"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "------VERIFICANDO A SOMA DOS VALORES DAS COLUNAS DE PAGAMENTO--------\n",
    "------Nessa etapa iremos verificar os valores contidos nas colunas de pagamento, para ter uma visão geral do banco de dados---\n",
    "\n",
    "----Fazer uma análise dos valores contidos na tabela, é importante por vários motivos:\n",
    "\n",
    "----Verificação da integridade dos dados: Ao analisar os valores nas tabelas, é possível identificar se existem valores inconsistentes, \n",
    "--como valores negativos onde deveriam ser positivos, valores nulos onde não deveriam ser, ou\n",
    "--valores que excedem limites pré-definidos. Essa verificação ajuda a garantir a integridade dos dados armazenados no banco de dados.\n",
    "\n",
    "--Identificação de discrepâncias e erros: Ao realizar cálculos e análises nos valores das tabelas, é possível identificar discrepâncias, \n",
    "--erros ou inconsistências nos dados. Por exemplo, se a soma de uma coluna que deveria representar um valor total não corresponder ao valor \n",
    "--esperado, pode indicar um problema nos dados ou nos processos de entrada de dados.\n",
    "\n",
    "--Estatísticas e métricas: Analisar os valores nas tabelas pode fornecer estatísticas e métricas importantes sobre os dados.\n",
    "--Por exemplo, ao calcular a soma total de um determinado campo, você pode obter informações sobre o total acumulado de valores em uma tabela. \n",
    "--Isso pode ser útil para análises financeiras, relatórios de desempenho, previsões e outras análises estatísticas.\n",
    "\n",
    "--Verificação de consistência entre tabelas: Ao comparar valores entre diferentes tabelas ou colunas, é possível identificar \n",
    "--discrepâncias ou inconsistências nos dados. Por exemplo, se houver uma tabela de pedidos e uma tabela de pagamentos, você pode \n",
    "--verificar se os valores totais dos pagamentos correspondem aos valores totais dos pedidos para garantir a consistência entre os dados.\n",
    "\n",
    "--Validação de resultados: Ao realizar cálculos complexos ou agregações nos valores das tabelas, é importante validar os resultados \n",
    "--para garantir sua precisão. Fazer análises de valores permite que você verifique se os resultados obtidos estão corretos e de acordo \n",
    "--com as expectativas."
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "----Aqui estamos somando todos os valores da COLUNA VLR_EMPENHO\n",
    "SELECT SUM(vlr_empenho) AS valor_total_empenhado\n",
    "FROM public.execucao_financeira_despesa; ----RESULTADO - 1337468033892.24\n",
    "---------------------------------------------------------------------------------------------------\n",
    "\n",
    "----Aqui estamos somando todos os valores da COLUNA VALOR_PAGO\n",
    "SELECT SUM(valor_pago) AS valor_pago\n",
    "FROM public.execucao_financeira_despesa; ---- RESULTADO - 105003461100.25\n",
    "---------------------------------------------------------------------------------------------------\n",
    "\n",
    "----Aqui estamos somando calculando o resultado da coluna de empenho meno o valor que foi pago, que deveria dar o resultado igual a coluna\n",
    "----valor resto a pagar\n",
    "SELECT SUM(vlr_empenho - valor_pago) AS resultado\n",
    "FROM public.execucao_financeira_despesa; ----- RESULTADO - 1224865353889.77 \n",
    "--OBS: Valor correto da operação se você fizer no excel ou calculadora dá 1232464572791.99. Diferença de: 7.599.218.902,22.\n",
    "---------------------------------------------------------------------------------------------------\n",
    "\n",
    "----Aqui estamos somando calculando o resultado da coluna valor resto a pagar, que deveria ser o resultado do empenho - valor pago.\n",
    "SELECT SUM(vlr_resto_pagar) AS vlr_resto_pagar\n",
    "FROM public.execucao_financeira_despesa; -----RESULTADO - 4000097535,35 \n",
    "--OBS: O valor esta diferente se pegar o (vlr_empenho - valor_pago), existem colunas sem valores, mesmo constando valores pagos, por isso a discrepância.\n",
    "---------------------------------------------------------------------------------------------------\n",
    "\n",
    "----Aqui estamos somando calculando o resultado da coluna liquidado, o que retorna zero, por que não existe valores.\n",
    "SELECT SUM(vlr_liquidado) AS vlr_liquidado\n",
    "FROM public.execucao_financeira_despesa; ---- RESULTADO - 0\n",
    "--OBS: O resultado dessa coluna seria com a seguinte lógica, se o valor do empenho for igual ao valor pago, significa que o empenho foi liquidado.\n",
    "\n",
    "\n",
    "\n",
    "----Passo a passo para a consulta:\n",
    "\n",
    "----A consulta começa com a cláusula \"SELECT\", que indica que queremos selecionar dados da tabela.\n",
    "----Em seguida, temos a função de agregação \"SUM(coluna)\". \n",
    "----A função SUM calcula a soma de todos os valores da coluna esepcificada da tabela \"execucao_financeira_despesa\".\n",
    "----Utilizamos o \"AS\" para atribuir um nome ao resultado da soma.\n",
    "----A cláusula \"FROM public.execucao_financeira_despesa\" especifica a tabela da qual queremos obter os dados. \n",
    "----\"public\" é o nome do esquema onde a tabela está localizada e \"execucao_financeira_despesa\" é o nome da tabela.\n",
    "----Ao executar essa consulta, o resultado retornado será a soma de todos os valores da coluna especificada da tabela \n",
    "----\"execucao_financeira_despesa\", representada pela coluna \"valor_total_empenhado\".\n",
    "\n",
    "\n",
    "\n"
   ]
  }
 ],
 "metadata": {
  "language_info": {
   "name": "python"
  },
  "orig_nbformat": 4
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
